/**
 * SendBird JavaScript SDK v3.0.0
 */
!function(e,n){e.SendBird=n}(this,function(e){function n(e){var n=new i(e);return n.messageType=i.MESSAGE_TYPE_ADMIN,n.message,n.data,e?(n.message=String(e.message),n.data=e.hasOwnProperty("data")?String(e.data):"",n):n}function t(){this.sessionKey;var e=0,n="JS,"+v.OSVersion+","+v.SDKVersion+","+v.appId;this.checkRouting=function(r){if(R)"function"==typeof r&&r({API_HOST:g,WS_HOST:U});else{var i=(new Date).getTime()/1e3;0==e||e-i>300?u(t.API_ROUTING_URL.replace("%s",v.appId),{},"GET",{SendBird:n+v.appId},function(n,t){return t?void r(null,new f("Server is unreachable.",_.NETWORK_ROUTING_ERROR)):(U=n.ws_server,g=n.api_server,e=i,void("function"==typeof r&&r({API_HOST:g,WS_HOST:U})))},function(e,n){r(null,new f(n,e))}):r(null,null)}};var r=function(e,r,i,a){t.sInstance.checkRouting(function(t,r){if(r)H.error(r),a(null,new f("Request failed.",_.REQUEST_FAILED));else{var s=new XMLHttpRequest;s.open("POST",g+e,!0),s.setRequestHeader("SendBird",n+P),s.setRequestHeader("Session-Key",v.APIClient.sessionKey);var o=new FormData;o.append("file",i),s.onload=function(){a(s.response)},s.onerror=function(e){a(null,new f(s.statusText,_.REQUEST_FAILED))},s.send(o)}})},i=function(e,r,i){"function"==typeof r&&(i=r,r={}),t.sInstance.checkRouting(function(t,a){a?i(null,new f("Request failed.",_.REQUEST_FAILED)):u(g+e,r,"DELETE",{"Session-Key":v.APIClient.sessionKey,SendBird:n+P},i)})},a=function(e,r,i){"function"==typeof r&&(i=r,r={});var a,s="";if(r){for(var o in r)""!=s&&(s+="&"),s+=o+"="+encodeURIComponent(r[o]);a=g+e+"?"+s}else a=g+e;t.sInstance.checkRouting(function(e,t){t?i(null,new f("Request failed.",_.REQUEST_FAILED)):u(a,r,"GET",{"Session-Key":v.APIClient.sessionKey,SendBird:n+P},i)})},s=function(e,r,i){"function"==typeof r&&(i=r,r={}),t.sInstance.checkRouting(function(t,a){a||u(g+e,r,"POST",{"Session-Key":v.APIClient.sessionKey,SendBird:n+P},i)})},o=function(e,r,i){"function"==typeof r&&(i=r,r={}),t.sInstance.checkRouting(function(t,a){a||u(g+e,r,"PUT",{"Session-Key":v.APIClient.sessionKey,SendBird:n+P},i)})},u=function(e,r,i,a,s){function o(){try{if("undefined"==typeof navigator||"undefined"==typeof navigator.userAgent)return!1;var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")?parseInt(e.split("msie")[1]):!1}catch(n){return!1}}var u=200,c=400;a.SendBird=n;var l;try{l="undefined"==typeof window?require("xhr2"):null}catch(d){l=null}if(l){var E=require("http"),_=require("https"),h=new E.Agent({keepAlive:!0,keepAliveMsecs:6e4}),A=new _.Agent({keepAlive:!0,keepAliveMsecs:6e4}),I={};I.httpAgent=h,I.httpsAgent=A,l.nodejsSet(I)}var N=l?new l:new XMLHttpRequest,p=o();if(!("withCredentials"in N)&&p&&10>p){N=new XDomainRequest,N.withCredentials=!0,N.open(i,e);for(var S in a)r[S]=a[S];N.onload=function(){var e=JSON.parse(N.responseText);e.error?s(null,{status:N.status,statusText:N.statusText}):s(e)},N.onerror=function(){s(null,{status:404,statusText:"There was a connection error"})}}else{try{N=l?new l:new XMLHttpRequest,N.open(i,e),N.onload=function(){if(N.status>=u&&N.status<c){if("function"==typeof s){var e=N.responseText;s(JSON.parse(e))}}else s(null,{status:N.status,statusText:N.statusText})},N.onerror=function(){s(null,{status:404,statusText:"There was a connection error"})}}catch(d){N=new ActiveXObject("Microsoft.XMLHTTP"),N.open(i,e),N.onreadystatechange=function(){if(4==N.readyState)if(N.status>=u&&N.status<c){var e=N.responseText;s(JSON.parse(e))}else s(null,{status:N.status,statusText:N.statusText})}}try{N.setRequestHeader("Content-Type",t.MIME_JSON);for(var S in a)N.setRequestHeader(S,a[S])}catch(C){}}try{switch(i){case"get":case"GET":N.send();break;default:N.send(JSON.stringify(r))}}catch(C){}};return this.groupChannelInvite=function(e,n,r){var i=t.API_GROUPCHANNELS_CHANNELURL_INVITE.replace("%s",encodeURIComponent(e)),a={},o=[];try{"Array"==n.constructor.name?o=n:o.push(n)}catch(u){H.error(u),r(null,new f("Invalid parameter.",_.INVALID_PARAMETER))}a.user_ids=o,s(i,a,r)},this.groupChannelHide=function(e,n,r){var i=t.API_GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(e)),a={};a.user_id=n,o(i,a,r)},this.groupChannelLeave=function(e,n,r){var i=t.API_GROUPCHANNELS_CHANNELURL_LEAVE.replace("%s",encodeURIComponent(e)),a={};a.user_id=n,o(i,a,r)},this.groupChannelMarkAsRead=function(e,n,r,i){var a=t.API_GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASREAD.replace("%s",encodeURIComponent(e)),s={};s.user_id=n,s.ts=r,o(a,s,i)},this.groupChannelMarkAsReadAll=function(e,n){var r=t.API_USERS_USERID_MARKASREADALL.replace("%s",encodeURIComponent(e)),i={};o(r,i,n)},this.messageList=function(e,n,r,i,s,o,u,c){var l;l=e?String(t.API_OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",n)):String(t.API_GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",n));var d={};d.is_sdk=String(!0),d.message_ts=String(r),d.prev_limit=String(i),d.next_limit=String(s),d.include=String(o),d.reverse=String(u),a(l,d,c)},this.login=function(e,n,r){var i=t.API_USERS_USERID_LOGIN.replace("%s",encodeURIComponent(e)),a={};a.app_id=v.SendBird.getApplicationId(),n&&(a.access_token=n),s(i,a,function(e,n){n?r(null,n):(v.APIClient.sessionKey=e.key,r(e,n))})},this.updateUserInfo=function(e,n,r,i){var a={};n&&(a.nickname=n),r&&(a.profile_url=r);var s=String(t.API_USERS_USERID).replace("%s",encodeURIComponent(e));o(s,a,i)},this.getGroupChannel=function(e,n,r,i){var s=t.API_GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(e)),o={member:String(n),read_receipt:String(r)};a(s,o,i)},this.getOpenChannel=function(e,n){var r=t.API_OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(e));a(r,n)},this.createGroupChannel=function(e,n,r,i,a,o){var u=t.API_GROUPCHANNELS,c={},l=[];"string"==typeof e?l.push(e):e.forEach(function(e){l.push(e)}),c.user_ids=l,c.is_distinct=n,r&&(c.name=r),i&&(c.cover_url=i),a&&(c.data=a),s(u,c,o)},this.createOpenChannel=function(e,n,r,i,a){var o=String(t.API_OPENCHANNELS),u={};e&&(u.name=e),n&&(u.cover_url=n),r&&(u.data=r),i&&("Array"==i.constructor.name?u.operators=i:u.operators=[i]),s(o,u,a)},this.createMetaCounters=function(e,n,r,i){var a;a=e?t.API_OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n)):t.API_GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n));var o={};o.metacounter=r,s(a,o,i)},this.updateMetaCounters=function(e,n,r,i,a,s){var u;u=e?t.API_OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n)):t.API_GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n));var c={};switch(c.metacounter=r,c.upsert=i,a){case t.UPDATE_META_COUNTER_MODE_SET:c.mode="set";break;case t.UPDATE_META_COUNTER_MODE_INC:c.mode="increase";break;case t.UPDATE_META_COUNTER_MODE_DEC:c.mode="decrease"}o(u,c,s)},this.getAllMetaCounters=function(e,n,t){this.getMetaCounters(e,n,{},t)},this.getMetaCounters=function(e,n,r,i){var s;s=e?t.API_OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n)):t.API_GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n));var o="";for(var u in r){var c=r[u];o+=","+c}var l=o,d={keys:l};a(s,d,i)},this.deleteMetaCounter=function(e,n,r,a){var s="";s=e?t.API_OPENCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(n)).replace("%s",r):t.API_GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(n)).replace("%s",r);var o={};i(s,o,a)},this.deleteAllMetaCounters=function(e,n,r){var a="";a=e?t.API_OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n)):t.API_GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(n));var s={};i(a,s,r)},this.createMetaData=function(e,n,r,i){var a="";a=e?t.API_OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)):t.API_GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n));var o={},u={};for(var c in r){var l=r[c];u[c]=l}o.metadata=u,s(a,o,i)},this.updateMetaData=function(e,n,r,i,a){var s="";s=e?t.API_OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)):t.API_GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n));var u={},c={};for(var l in r){var d=r[l];c[l]=d}u.metadata=c,u.upsert=i,o(s,u,a)},this.getAllMetaData=function(e,n,t){this.getMetaData(e,n,{},t)},this.getMetaData=function(e,n,r,i){var s="";s=e?t.API_OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)):t.API_GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n));var o="";for(var u in r){var c=r[u];o+=","+c}var l=o,d={keys:l};a(s,d,i)},this.deleteMetaData=function(e,n,r,a){var s="";s=e?t.API_OPENCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(n)).replace("%s",r):t.API_GROUPCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(n)).replace("%s",r),i(s,{},a)},this.deleteAllMetaData=function(e,n,r){var a="";a=e?t.API_OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)):t.API_GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(n)),i(a,{},r)},this.loadUserList=function(e,n,r){var i=t.API_USERS,s={token:e,limit:String(n)};a(i,s,r)},this.loadBlockedUserList=function(e,n,r,i){var s=t.API_USERS_USERID_BLOCK.replace("%s",encodeURIComponent(e)),o={token:n,limit:String(r)};a(s,o,i)},this.loadOpenChannelList=function(e,n,r){var i=t.API_OPENCHANNELS,s={token:e,limit:String(n)};a(i,s,r)},this.uploadFile=function(e,n){r(t.API_STORAGE_FILE,{},e,n)},this.uploadProfileImage=function(e,n){r(t.API_STORAGE_PROFILE,{},e,n)},this.loadUserGroupChannelList=function(e,n,r,i,s,o){var u=t.API_GROUPCHANNELS,c={user_id:e,token:n,limit:String(r),member:!0,show_empty:String(i),order:s};a(u,c,o)},this.loadOpenChannelParticipantList=function(e,n,r,i){var s=t.API_OPENCHANNELS_CHANNELURL_PARTICIPANTS.replace("%s",e),o={token:n,limit:String(r)};a(s,o,i)},this.loadOpenChannelMutedList=function(e,n,r,i){var s=t.API_OPENCHANNELS_CHANNELURL_MUTE.replace("%s",e),o={token:n,limit:String(r)};a(s,o,i)},this.loadOpenChannelBanList=function(e,n,r,i){var s=t.API_OPENCHANNELS_CHANNELURL_BAN.replace("%s",e),o={token:n,limit:String(r)};a(s,o,i)},this.registerGCMPushToken=function(e,n,r){var i=t.API_USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(e)),a={gcm_reg_token:n};s(i,a,r)},this.unregisterGCMPushToken=function(e,n,r){var a=t.API_USERS_USERID_PUSH_GCM_TOKEN.replace("%s",encodeURIComponent(e)).replace("%s",encodeURIComponent(n));i(a,r)},this.unregisterGCMPushTokenAll=function(e,n){var r=t.API_USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(e));i(r,n)},this.registerAPNSPushToken=function(e,n,r){var i=t.API_USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(e)),a={gcm_reg_token:n};s(i,a,r)},this.unregisterAPNSPushToken=function(e,n,r){var i=t.API_USERS_USERID_PUSH_APNS_TOKEN.replace("%s",encodeURIComponent(e)).replace("%s",encodeURIComponent(n));o(i,r)},this.unregisterAPNSPushTokenAll=function(e,n,r){var a=t.API_USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(e));i(a,r)},this.blockUser=function(e,n,r){var i=t.API_USERS_USERID_BLOCK.replace("%s",encodeURIComponent(e)),a={target_id:n};s(i,a,r)},this.unblockUser=function(e,n,r){var i=t.API_USERS_USERID_BLOCK_TARGETID.replace("%s",encodeURIComponent(e)).replace("%s",encodeURIComponent(n));s(i,{},r)},this.banUser=function(e,n,r,i,a){var o=t.API_OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(e)),u={user_id:n};r&&(u.description=r),u.seconds=String(i),s(o,u,a)},this.unbanUser=function(e,n,r){var a=t.API_OPENCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(e)).replace("%s",encodeURIComponent(n));i(a,{},r)},this.muteUser=function(e,n,r){var i=t.API_OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(e)),a={user_id:n};s(i,a,r)},this.unmuteUser=function(e,n,r){var a=t.API_OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(e)).replace("%s",encodeURIComponent(n));i(a,{},r)},this.deleteMessage=function(e,n,r,a){var s="";s=e?t.API_OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(n)).replace("%s",encodeURIComponent(r)):t.API_GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(n)).replace("%s",encodeURIComponent(r)),i(s,{},a)},this}function r(e){var n=this;return this.___update=function(e){this.url=String(e.channel_url),this.name=String(e.name),this.createdAt=e.hasOwnProperty("created_at")?1e3*e.created_at:0,this.coverUrl=String(e.cover_url),this.data=String(e.data)},this.isGroupChannel=function(){return this.channelType==r.CHANNEL_TYPE_GROUP},this.isOpenChannel=function(){return this.channelType==r.CHANNEL_TYPE_OPEN},this.createPreviousMessageListQuery=function(){return new S(this)},this.createMessageListQuery=function(){return new l(this)},this.sendFileMessage=function(){switch(arguments.length){case 2:var e=arguments[0],t=arguments[1];if("string"==typeof e)var r="",i="",a="";else var r=e.name,i=e.type,a=e.size;break;case 3:var e=arguments[0],u=arguments[1],t=arguments[2];if("string"==typeof e)var r="",i="",a="";else var r=e.name,i=e.type,a=e.size;break;case 6:var e=arguments[0],r=arguments[1],i=arguments[2],a=arguments[3],u=arguments[4],t=arguments[5]}var c=n.url,l=function(e,n,t,r,i,a,u){var c=s.generateRequestId(),l=s.bFile(c,e,n,t,r,i,a);v.SendBird.sendCommand(l,function(e,n){if(n)return void(u&&u(null,n));var t=new o(e.getJsonElement());u&&u(t)})};if("string"==typeof e){var d=e;l(c,d,r,i,a,u,t)}else v.APIClient.uploadFile(e,function(e,n){if(n)return void(t&&t(null,n));var s=JSON.parse(e),o=s.url;l(c,o,r,i,a,u,t)})},this.sendUserMessage=function(e,n,t){"function"==typeof n&&(t=n,n=null);var r=s.bMessage(this.url,e,n,[]),i=I.build(r.requestId,0,v.SendBird.getInstance().currentUser,this,e,n,(new Date).getTime()),a=new I(i);return v.SendBird.getInstance().sendCommand(r,function(e,n){if(n)return void(t&&t(null,n));var r=new I(e.getJsonElement());t&&t(r)}),a},this.createMetaCounters=function(e,n){t.getInstance().createMetaCounters(this.isOpenChannel(),this.url,e,function(e,t){return t?void n(null,t):void(n&&n(e))})},this.updateMetaCounters=function(e,n,r){t.getInstance().updateMetaCounters(this.isOpenChannel(),this.url,e,n,v.APIClient.UPDATE_META_COUNTER_MODE_SET,function(e,n){return n?void r(null,n):void(r&&r(e))})},this.increaseMetaCounters=function(e,n){t.getInstance().updateMetaCounters(this.isOpenChannel(),this.url,e,!1,t.UPDATE_META_COUNTER_MODE_INC,function(e,t){return t?void n(null,t):void(n&&n(e))})},this.decreaseMetaCounters=function(e,n){t.getInstance().updateMetaCounters(this.isOpenChannel(),this.url,e,!1,t.UPDATE_META_COUNTER_MODE_DEC,function(e,t){if(t)return void n(null,t);var r=e,i={};for(var a in r){var s=r[a];i[a]=s}"function"==typeof n&&n(i,null)})},this.getMetaCounters=function(e,n){t.getInstance().getMetaCounters(this.isOpenChannel(),this.url,e,function(e,t){return t?void n(null,t):void("function"==typeof n&&n(e,null))})},this.getAllMetaCounters=function(e){t.getInstance().getAllMetaCounters(this.isOpenChannel(),this.url,function(n,t){return t?void e(null,t):void("function"==typeof e&&e(n,null))})},this.deleteMetaCounter=function(e,n){t.getInstance().deleteMetaCounter(this.isOpenChannel(),this.url,e,function(e,t){return t?void n(null,t):void(n&&n(e,null))})},this.deleteAllMetaCounters=function(e){t.getInstance().deleteAllMetaCounters(this.isOpenChannel(),this.url,function(n,t){return t?void(e&&e(null,t)):void(e&&e(n,null))})},this.createMetaData=function(e,n){t.getInstance().createMetaData(this.isOpenChannel(),this.url,e,function(e,t){return t?void n(null,t):void(n&&n(e,null))})},this.updateMetaData=function(e,n,r){t.getInstance().updateMetaData(this.isOpenChannel(),this.url,e,n,function(e,n){return n?void r(null,n):void(r&&r(e,null))})},this.getMetaData=function(e,n){t.getInstance().getMetaData(this.isOpenChannel(),this.url,e,function(e,t){return t?void n(null,t):void(n&&n(e,null))})},this.getAllMetaData=function(e){t.getInstance().getAllMetaData(this.isOpenChannel(),this.url,function(n,t){return t?void e(null,t):void(e&&e(n,null))})},this.deleteMetaData=function(e,n){t.getInstance().deleteMetaData(this.isOpenChannel(),this.url,e,function(e,t){return t?void n(null,t):void(n&&n(e,null))})},this.deleteAllMetaData=function(e){t.getInstance().deleteAllMetaData(this.isOpenChannel(),this.url,function(n,t){return t?void(e&&e(null,t)):void(e&&e(n,null))})},this.deleteMessage=function(e,n){return e?void t.getInstance().deleteMessage(this.isOpenChannel(),this.url,e.messageId,function(e,t){return t?void(n&&n(null,t)):void(n&&n())}):void(n&&n(null,new f("Invalid arguments.",_.INVALID_PARAMETER)))},this.channelType=r.CHANNEL_TYPE_BASE,this.url,this.name,this.coverUrl,this.createdAt,this.data,e?(this.___update(e),this):this}function i(e){return this.isOpenChannel=function(){return this.channelType==r.CHANNEL_TYPE_OPEN},this.isGroupChannel=function(){return this.channelType==r.CHANNEL_TYPE_GROUP},this.messageType,this.messageId,this.channelUrl,this.createdAt,this.channelType,e?(this.messageType=i.MESSAGE_TYPE_BASE,this.messageId=e.hasOwnProperty("msg_id")?parseInt(e.msg_id):0,this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.createdAt=e.hasOwnProperty("ts")?parseInt(e.ts):0,this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):r.CHANNEL_TYPE_GROUP,this.isUserMessage=function(){return this.messageType==i.MESSAGE_TYPE_USER},this.isAdminMessage=function(){return this.messageType==i.MESSAGE_TYPE_ADMIN},void(this.isFileMessage=function(){return this.messageType==i.MESSAGE_TYPE_FILE})):this}function a(e){return this.isGroupChannel=function(){return this.channelType==r.CHANNEL_TYPE_GROUP},this.isOpenChannel=function(){return this.channelType==r.CHANNEL_TYPE_OPEN},e?(this.category=e.hasOwnProperty("cat")?parseInt(e.cat):0,this.data=e.hasOwnProperty("data")?e.data:null,this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):r.CHANNEL_TYPE_GROUP,this):this}function s(e,n,t){this.isAckRequired=function(){return"MESG"==this.command||"FILE"==this.command||"ENTR"==this.command||"EXIT"==this.command},this.encode=function(){return this.command+this.payload+"\n"};if(this.getJsonElement=function(){return JSON.parse(this.payload)},this.isRequestIdCommand=function(){return this.isAckRequired()||"EROR"==this.command},this.command,this.payload,this.requestId,0==arguments.length)return this;var r;switch(arguments.length){case 1:var i=arguments[0];if(!i||i.length<=4)return this.command="NOOP",void(this.payload="{}");if(i=i.trim(),this.command=i.substring(0,4),this.payload=i.substring(4),this.isRequestIdCommand()){var a=this.getJsonElement();a&&(this.requestId=a.hasOwnProperty("req_id")?a.req_id:"")}break;case 3:r=arguments[2];case 2:var o=arguments[0],u=arguments[1];r=r?r:"",this.command=o,this.requestId=r,this.requestId||this.isRequestIdCommand()&&(this.requestId=s.generateRequestId()),u.req_id=this.requestId,this.payload=JSON.stringify(u)}return this}function o(e){var n=new i(e);return n.messageType=i.MESSAGE_TYPE_FILE,n.sender,n.url,n.name,n.size,n.type,n.data,n.reqId,e?(n.sender=new h(e.user),n.url=String(e.url),n.name=e.hasOwnProperty("name")?e.name:"File",n.size=parseInt(e.size),n.type=String(e.type),n.data=String(e.custom),n.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",n):n}function u(e){var n=new r(e);n.channelType=r.CHANNEL_TYPE_GROUP;var a,o,c={},l=!1;n.isDistinct,n.unreadMessageCount=0,n.members=[],n.memberMap={},n.lastMessage,n.memberCount,n.cachedReadReceiptStatus={},n.refresh=function(e){u.getChannelWithoutCache(n.url,function(n,t){return t?void(e&&e(null,t)):void(e&&e())})},n.__update=function(e){n.___update(e),n.__parse(e)},n.__parse=function(e){if(n.isDistinct=!!e.is_distinct,n.unreadMessageCount=parseInt(e.unread_message_count),e.hasOwnProperty("read_receipt")){n.cachedReadReceiptStatus={};for(var t in e.read_receipt){var r=e.read_receipt[t];n.updateReadReceipt(t,parseInt(r))}}if(e.hasOwnProperty("members")){n.members=[],n.memberMap={};var a=e.members;a.forEach(function(e){var t=new h(e);n.members.push(t),n.memberMap[t.userId]=t}),n.memberCount=n.members.length}e.hasOwnProperty("member_count")&&(n.memberCount=parseInt(e.member_count)),e.hasOwnProperty("last_message")&&"object"==typeof e.last_message&&e.last_message?n.lastMessage=i.build(e.last_message,n):n.lastMessage=null};var d=function(e){if(e instanceof h){var n=[];return n.push(e.userId),n}if(Array.isArray(e)){var n=[];return e.forEach(function(e){e instanceof h&&n.push(e.userId),parseInt(e)>0&&n.push(e)}),n}if(parseInt(e)>0){var n=[];return n.push(e),n}};n.invite=function(e,t){var r=d(e);n.inviteWithUserIds(r,t)},n.inviteWithUserIds=function(e,r){t.getInstance().groupChannelInvite(n.url,e,function(e,n){return n?void(r&&r(null,n)):(u.__upsert(e),void(r&&r(null)))})},n.hide=function(e){t.getInstance().groupChannelHide(n.url,v.SendBird.currentUser.userId,function(n,t){return t?void(e&&e(null,t)):void(e&&e(n))})},n.leave=function(e){t.getInstance().groupChannelLeave(n.url,v.SendBird.currentUser.userId,function(n,t){return t?void(e&&e(null,t)):void(e&&e())})},n.markAsRead=function(e){return e?void 0:void(l=!0)},n.fireMarkAsRead=function(){l&&(l=!1,H.log("fireMarkAsRead scheduled, sendMarkAsRead()"),E(function(e,n){}))};var E=function(e,r){return v.SendBird.currentUser?void t.getInstance().groupChannelMarkAsRead(n.url,v.SendBird.currentUser.userId,e,function(e,t){return t?void(r&&r(t)):(n.unreadMessageCount=0,void(r&&r()))}):void r(null,new f("Connection must be made before you mark as read.",_.CONNECTION_REQUIRED))};return n.getReadReceipt=function(e){if(e instanceof i||H.error("message is not BaseMessage instance"),e.messageType==e.MESSAGE_TYPE_ADMIN)return 0;var t,r,a=v.SendBird.currentUser,s=0,o=e.createdAt,u=n.members;for(var c in u){var l=u[c],t=l.userId;if(a.userId!=t){var r=n.cachedReadReceiptStatus[t];o>r&&s++}}return s},n.updateReadReceipt=function(e,t){var r=e,i=n.cachedReadReceiptStatus[r],a=t;(!i||a>i)&&(n.cachedReadReceiptStatus[r]=a)},n.startTyping=function(){var e=(new Date).getTime();if(!(1e3>e-a)){o=0,a=e;var t=s.bTypeStart(n.url,a);v.SendBird.getInstance().sendCommand(t,null)}},n.endTyping=function(){var e=(new Date).getTime();if(!(1e3>e-o)){a=0,o=e;var t=s.bTypeEnd(n.url,o);v.SendBird.getInstance().sendCommand(t,null)}},n.invalidateTypingStatus=function(){var e=!1,n=(new Date).getTime();for(var t in c){var r=c[t];n-r>=1e4&&(delete c[t],e=!0)}return e},n.updateTypingStatus=function(e,n){n?c[e.userId]=(new Date).getTime():delete c[e.userId]},n.isTyping=function(){for(var e in c)return!0;return!1},n.getTypingMembers=function(){var e=[];for(var t in c){var r=n.memberMap[t];n.memberMap[t]&&e.push(r)}return e},n.addMember=function(e){n.removeMember(e),n.memberMap[e.userId]=e,n.members.push(e),n.memberCount++,n.updateReadReceipt(e.userId,0)},n.removeMember=function(e){var t=e.userId;if(n.memberMap.hasOwnProperty(e.userId)){delete n.memberMap[e.userId];for(var r in n.members){var i=n.members[r];if(i.userId==t){n.members.splice(r,1);break}}n.memberCount--}},e?(n.__parse(e),n):n}function c(e){this.isLoading=!1,this.limit=20,this.includeEmpty=!1,this.order=c.ORDER_LATEST_LAST_MESSAGE,this.hasNext=!0;var n=this,r=e,i="";this.next=function(e){return n.hasNext?(n.isLoading&&e(null,new f("Query in progress.",_.QUERY_IN_PROGRESS)),n.isLoading=!0,void t.getInstance().loadUserGroupChannelList(r.userId,i,n.limit,n.includeEmpty,n.order,function(t,r){if(r)return n.isLoading=!1,void(e&&e(null,r));var a=t;i=String(a.next),(!i||i.length<=0)&&(n.hasNext=!1);var s=a.channels,o=[];for(var c in s){var l=u.__upsert(s[c]);o.push(l)}n.isLoading=!1,e&&e(o,null)})):void e([],null)}}function l(e){this.isLoading=!1;var n=this,r=e;this.next=function(e,a,s,o){return n.isLoading?void o(null,new f("Query in progress.",_.QUERY_IN_PROGRESS)):(n.isLoading=!0,void t.getInstance().messageList(r.isOpenChannel(),r.url,e,0,a,!1,s,function(e,t){if(t)return n.isLoading=!1,void(o&&o(null,t));var a=e,s=a.messages,u=[];for(var c in s){var l=new i(s[c],r);l&&u.push(l)}n.isLoading=!1,o&&o(u)}))},this.prev=function(e,a,s,o){return n.isLoading?void o(null,new f("Query in progress.",_.QUERY_IN_PROGRESS)):(n.isLoading=!0,void t.getInstance().messageList(r.isOpenChannel(),r.url,e,a,0,!1,s,function(e,t){if(t)return n.isLoading=!1,void(o&&o(null,t));var a=e,s=a.messages,u=[];for(var c in s){var l=new i(s[c],r);l&&u.push(l)}n.isLoading=!1,o&&o(u)}))},this.load=function(e,a,s,o,u){return n.isLoading?void u(null,new f("Query in progress.",_.QUERY_IN_PROGRESS)):(n.isLoading=!0,void t.getInstance().messageList(r.isOpenChannel(),r.url,e,a,s,!0,o,function(e,t){if(t)return n.isLoading=!1,void(u&&u(null,t));var a=e,s=a.messages,o=[];for(var c in s){var l=new i(s[c],r);l&&o.push(l)}n.isLoading=!1,u&&u(o)}))}}function d(e){var n=new r(e);return n.channelType=r.CHANNEL_TYPE_OPEN,n.participantCount,n.operators=[],n.refresh=function(e){d.getChannelWithoutCache(n.url,function(n,t){return t?void(e&&e(null,t)):void(e&&e())})},n.__parse=function(e){if(e.hasOwnProperty("participant_count")&&(n.participantCount=parseInt(e.participant_count)),e.hasOwnProperty("operators")&&e.operators){n.operators=[];for(var t in e.operators){var r=new h(e.operators[t]);n.operators.push(r)}}},n.__update=function(e){n.___update(e),n.__parse(e)},n.enter=function(e){var t=s.bEnter(n.url);v.SendBird.getInstance().sendCommand(t,function(t,r){return r?void(e&&e(null,r)):(d.enteredChannels[n.url]=n,void(e&&e(null)))})},n.exit=function(e){var t=s.bExit(n.url);v.SendBird.getInstance().sendCommand(t,function(t,r){return r?void(e&&e(null,r)):(delete d.enteredChannels[n.url],void(e&&e(null)))})},n.createParticipantListQuery=function(){return new A(A.PARTICIPANT,n)},n.createMutedUserListQuery=function(){return new A(A.MUTED_USER,n)},n.createBannedUserListQuery=function(){return new A(A.BANNED_USER,n)},n.banUser=function(e,t,r){return!e||parseInt(t)<0?void(r&&r(null,new f("Invalid parameter.",_.INVALID_PARAMETER))):void n.banUserWithUserId(e.userId,t,r)},n.banUserWithUserId=function(e,r,i){return!e||parseInt(r)<0?void(i&&i(null,new f("Invalid parameter.",_.INVALID_PARAMETER))):void t.getInstance().banUser(n.url,e,null,r,function(e,n){return n?void(i&&i(null,n)):void(i&&i())})},n.unbanUser=function(e,t){return e?void n.unbanUserWithUserId(e.userId,t):void(t&&t(null,new f("Invalid parameter.",_.INVALID_PARAMETER)))},n.unbanUserWithUserId=function(e,r){return e?void t.getInstance().unbanUser(n.url,e,function(e,n){return n?void(r&&r(null,n)):void(r&&r())}):void(r&&r(null,new f("Invalid parameter.",_.INVALID_PARAMETER)))},n.muteUser=function(e,t){return e?void n.muteUserWithUserId(e.userId,t):void(t&&t(null,new f("Invalid parameter.",_.INVALID_PARAMETER)))},n.muteUserWithUserId=function(e,r){return e?void t.getInstance().muteUser(n.url,e,function(e,n){return n?void(r&&r(null,n)):void(r&&r())}):void(r&&r(null,new f("Invalid parameter.",_.INVALID_PARAMETER)))},n.unmuteUser=function(e,t){return e?void n.unmuteUserWithUserId(e.userId,t):void(t&&t(null,new f("Invalid parameter.",_.INVALID_PARAMETER)))},n.unmuteUserWithUserId=function(e,r){return e?void t.getInstance().unmuteUser(n.url,e,function(e,n){return n?void(r&&r(null,n)):void(r&&r())}):void(r&&r(null,new f("Invalid parameter.",_.INVALID_PARAMETER)))},n.isOperator=function(e){return e?n.isOperatorWithUserId(e.userId):!1},n.isOperatorWithUserId=function(e){for(var t in n.operators)if(n.operators[t].userId==e)return!0;return!1},e?(n.__parse(e),n):n}function E(e){var i,c=null,l=1e4;this.loginTimer,this.globalTimer,this.getInstance=function(){return c},this.connectionState={CONNECTING:"CONNECTING",OPEN:"OPEN",CLOSING:"CLOSING",CLOSED:"CLOSED"},this.getConnectionState=function(){if(!c)return this.connectionState.CLOSED;try{return v.WSClient?v.WSClient.getConnectionState():c.connectionState.CLOSED}catch(e){return c.connectionState.CLOSED}},this.getApplicationId=function(){return i};var p={},S=function(e){return p.hasOwnProperty(e)?p[e]:null};this.currentUser=null;var R=function(e){var t=new s(e);if(t.requestId){var i=S(t.requestId);if(null==i)return;clearTimeout(i.timer);var a=i.handler;if(a)if("EROR"==t.command){var c=t.getJsonElement(),l=c.code,E=c.message;a(t,new f(E,l))}else a(t,null)}else switch(t.command){case"LOGI":clearTimeout(v.SendBird.loginTimer);break;case"MESG":if(!_)var _=new I(t.getJsonElement());case"FILE":if(!_)var _=new o(t.getJsonElement());case"BRDM":case"ADMM":if(!_)var _=new n(t.getJsonElement());if(!_)return;_.isGroupChannel()?u.getChannel(_.channelUrl,function(e,n){if(n)return void(a&&a(null,n));e.lastMessage=_,e.unreadMessageCount++;for(var t in v.SendBird.channelHandlers){var r=v.SendBird.channelHandlers[t];r.onMessageReceived(e,_)}}):d.getChannel(_.channelUrl,function(e,n){if(n)return void(a&&a(null,n));for(var t in v.SendBird.channelHandlers){var r=v.SendBird.channelHandlers[t];r.onMessageReceived(e,_)}});break;case"READ":var h=new C(t.getJsonElement());new u.getChannel(h.channelUrl,function(e,n){if(n)return void(a&&a(null,n));e.updateReadReceipt(h.reader.userId,h.timestamp);for(var t in v.SendBird.channelHandlers){var r=v.SendBird.channelHandlers[t];r.onReadReceiptUpdated(e)}});break;case"TPST":case"TPEN":break;case"MTIO":break;case"SYEV":g(t);break;case"DELM":var A=t.getJsonElement(),N=String(A.channel_type),p=String(A.channel_url),R=String(A.msg_id);switch(N){case r.CHANNEL_TYPE_OPEN:d.getChannel(p,function(e,n){if(n)return void O.error("Discard a command.");for(var t in v.SendBird.channelHandlers){var r=v.SendBird.channelHandlers[t];r.onMessageDeleted(e,R)}});break;case r.CHANNEL_TYPE_GROUP:u.getChannel(p,function(e,n){if(n)return void O.error("Discard a command.");for(var t in v.SendBird.channelHandlers){var r=v.SendBird.channelHandlers[t];r.onMessageDeleted(e,R)}})}break;case"LEAV":break;case"JOIN":break;case"PONG":}},g=function(e){O.log("## processChannelEvent called");var n=new a(e.getJsonElement());switch(n.category){case a.CATEGORY_CHANNEL_JOIN:case a.CATEGORY_CHANNEL_LEAVE:O.log("######### JOIN/LEAVE"),u.getChannel(n.channelUrl,function(t,r){if(r)return void H.error("Discard a command: "+e.command+":"+n.category);var i=new h(n.data);if(O.log(i,n.data),n.category==a.CATEGORY_CHANNEL_JOIN){t.addMember(i);for(var s in v.SendBird.channelHandlers){var o=v.SendBird.channelHandlers[s];o.onUserJoined(t,i)}}else{t.removeMember(i);for(var s in v.SendBird.channelHandlers){var o=v.SendBird.channelHandlers[s];o.onUserLeft(t,i)}}});break;case a.CATEGORY_TYPING_START:case a.CATEGORY_TYPING_END:u.getChannel(n.channelUrl,function(t,r){if(r)return void H.error("Discard a command: "+e.command+":"+n.category);var i=new h(n.data);n.category==a.CATEGORY_TYPING_START?t.updateTypingStatus(i,!0):t.updateTypingStatus(i,!1);for(var s in v.SendBird.channelHandlers){var o=v.SendBird.channelHandlers[s];o.onTypingStatusUpdated(t)}});break;case a.CATEGORY_CHANNEL_ENTER:case a.CATEGORY_CHANNEL_EXIT:d.getChannel(n.channelUrl,function(t,r){if(r)return void H.error("Discard a command: "+e.command+":"+n.category);var i=new h(n.data);if(n.category==a.CATEGORY_CHANNEL_ENTER){t.participantCount++;for(var s in v.SendBird.channelHandlers){var o=v.SendBird.channelHandlers[s];o.onUserEntered(t,i)}}else{t.participantCount--;for(var s in v.SendBird.channelHandlers){var o=v.SendBird.channelHandlers[s];o.onUserExited(t,i)}}});break;case a.CATEGORY_USER_CHANNEL_MUTE:case a.CATEGORY_USER_CHANNEL_UNMUTE:d.getChannel(n.channelUrl,function(t,r){if(r)return void H.error("Discard a command: "+e.command+":"+n.category);var i=new h(n.data);if(n.category==a.CATEGORY_USER_CHANNEL_MUTE)for(var s in v.SendBird.channelHandlers){var o=v.SendBird.channelHandlers[s];o.onUserMuted(t,i)}else for(var s in v.SendBird.channelHandlers){var o=v.SendBird.channelHandlers[s];o.onUserUnmuted(t,i)}});break;case a.CATEGORY_USER_CHANNEL_BAN:case a.CATEGORY_USER_CHANNEL_UNBAN:d.getChannel(n.channelUrl,function(t,r){if(r)return void H.error("Discard a command: "+e.command+":"+n.category);var i=new h(n.data);if(n.category==a.CATEGORY_USER_CHANNEL_BAN)for(var s in v.SendBird.channelHandlers){var o=v.SendBird.channelHandlers[s];o.onUserBanned(t,i)}else for(var s in v.SendBird.channelHandlers){var o=v.SendBird.channelHandlers[s];
o.onUserUnbanned(t,i)}});break;case a.CATEGORY_CHANNEL_FREEZE:case a.CATEGORY_CHANNEL_UNFREEZE:d.getChannel(n.channelUrl,function(t,r){if(r)return void H.error("Discard a command: "+e.command+":"+n.category);if(n.category==a.CATEGORY_CHANNEL_FREEZE)for(var i in v.SendBird.channelHandlers){var s=v.SendBird.channelHandlers[i];s.onChannelFrozen(t)}else for(var i in v.SendBird.channelHandlers){var s=v.SendBird.channelHandlers[i];s.onChannelUnfrozen(t)}});break;case a.CATEGORY_CHANNEL_DELETED:if(n.isGroupChannel())for(var t in v.SendBird.channelHandlers){var r=v.SendBird.channelHandlers[t];r.onChannelDeleted(n.channelUrl,"group")}else for(var t in v.SendBird.channelHandlers){var r=v.SendBird.channelHandlers[t];r.onChannelDeleted(n.channelUrl,"open")}break;case a.CATEGORY_CHANNEL_PROP_CHANGED:n.isOpenChannel()?d.getChannelWithoutCache(n.channelUrl,function(t,r){if(r)return void H.error("Discard a command: "+e.command+":"+n.category);for(var i in v.SendBird.channelHandlers){var a=v.SendBird.channelHandlers[i];a.onChannelChanged(t)}}):u.getChannelWithoutCache(n.channelUrl,function(t,r){if(r)return void H.error("Discard a command: "+e.command+":"+n.category);for(var i in v.SendBird.channelHandlers){var a=v.SendBird.channelHandlers[i];a.onChannelChanged(t)}})}};this.connect=function(e,n,t){"function"==typeof n&&(t=n,n=null),c.currentUser&&c.currentUser.userId==e?m(c.currentUser,t):v.APIClient.login(e,n,function(e,n){if(n)c.disconnect(),t&&t(null,n);else{var r=new h(e);m(r,t)}})},this.createUserListQuery=function(){return new A},this.disconnect=function(e){clearTimeout(v.SendBird.globalTimer),clearTimeout(v.SendBird.loginTimer),v.SendBird.currentUser=null,e&&e()};var m=function(e,n){if(!v.WSClient){var t=new N.WSClientHandler;t.onMessage=function(e){R(e)},t.onOpen=function(r){t.isOpened=!0,v.SendBird.loginTimer=setTimeout(function(){v.SendBird.disconnect(null),n&&n(null,new f("Connection timeout.",_.LOGIN_TIMEOUT))},l),v.SendBird.currentUser=e,clearTimeout(v.SendBird.globalTimer);var i=function(){if(u.cachedChannels)for(var e in u.cachedChannels){var n=u.cachedChannels[e];if(n.fireMarkAsRead(),n.invalidateTypingStatus())for(var t in v.SendBird.channelHandlers){var r=v.SendBird.channelHandlers[t];r.onTypingStatusUpdated(n)}}v.SendBird.globalTimer=setTimeout(function(){i()},1e3)};i()},t.onError=function(e){O.error("WSClientHandler.onError",e)},t.onClose=function(e){t.isOpened=!1,v.SendBird.disconnect()},t.onErrorClose=function(e){t.isOpened=!1},t.onReconnectStarted=function(){for(var e in v.SendBird.connectionHandlers){var n=v.SendBird.connectionHandlers[e];n.onReconnectStarted(e)}},t.onReconnectFailed=function(){for(var e in v.SendBird.connectionHandlers){var n=v.SendBird.connectionHandlers[e];n.onReconnectFailed(e)}},t.onReconnectSucceeded=function(){for(var e in v.SendBird.connectionHandlers){var n=v.SendBird.connectionHandlers[e];n.onReconnectSucceeded(e)}},v.WSClient=new N(this.appId,c.SDKVersion,v.APIClient.sessionKey,t)}v.APIClient.checkRouting(function(t,r){v.WSClient.connect(e,U,n)})};return this.sendCommand=function(e,n){if(null==v.WSClient||v.WSClient.getConnectionState()!=v.SendBird.connectionState.OPEN)return void(n&&n(null,new f("WS connection closed.",_.WEBSOCKET_CONNECTION_CLOSED)));if(e.isAckRequired()){var t=e.requestId,r={handler:n,timer:setTimeout(function(){n(null,new f("Command received no ack.",_.ACK_TIMEOUT)),delete p[t]},l)};p[t]=r,v.WSClient.send(e,function(e,t){return t?(clearTimeout(r.timer),void n(null,t)):void 0})}else v.WSClient.send(e,n)},this.channelHandlers={},this.ChannelHandler=function(){this.onMessageReceived=function(e,n){},this.onMessageDeleted=function(e,n){},this.onReadReceiptUpdated=function(e){},this.onTypingStatusUpdated=function(e){},this.onUserJoined=function(e,n){},this.onUserLeft=function(e,n){},this.onUserEntered=function(e,n){},this.onUserExited=function(e,n){},this.onUserMuted=function(e,n){},this.onUserUnmuted=function(e,n){},this.onUserBanned=function(e,n){},this.onUserUnbanned=function(e,n){},this.onChannelFrozen=function(e){},this.onChannelUnfrozen=function(e){},this.onChannelChanged=function(e){},this.onChannelDeleted=function(e){}},this.addChannelHandler=function(e,n){c.channelHandlers[e]=n},this.removeChannelHandler=function(e){delete c.channelHandlers[e]},this.connectionHandlers={},this.ConnectionHandler=function(){this.onReconnectStarted=function(){},this.onReconnectSucceeded=function(){},this.onReconnectFailed=function(){}},this.addConnectionHandler=function(e,n){c.connectionHandlers[e]=n},this.removeConnectionHandler=function(e){delete c.connectionHandlers[e]},this.createUserListQuery=function(){return new A(A.ALL_USER)},this.createBlockedUserListQuery=function(){return new A(A.BLOCKED_USER)},this.updateCurrentUserInfoWithProfileImage=function(e,n,r){return v.SendBird.currentUser?void(n?t.getInstance().uploadProfileImage(n,function(n,t){if(t)return void(r&&r(t));var i=n.url;this.updateCurrentUserInfo(e,i,r)}):this.updateCurrentUserInfo(e,null,r)):void(r&&r(null,new f("Connection must be made before you update user information.",_.INVALID_INITIALIZATION)))},this.updateCurrentUserInfo=function(e,n,r){return v.SendBird.currentUser?void t.getInstance().updateUserInfo(v.SendBird.currentUser.userId,e,n,function(t,i){return i?void(r&&r(null,i)):(e&&(v.SendBird.currentUser.nickname=e),n&&(v.SendBird.currentUser.profileUrl=n),void(r&&r()))}):void(r&&r(null,new f("Connection must be made before you update user information.",_.INVALID_INITIALIZATION)))},this.registerGCMPushTokenForCurrentUser=function(e,n){return v.SendBird.currentUser?void t.getInstance().registerGCMPushToken(v.SendBird.currentUser.userId,e,function(e,t){return t?void(n&&n(null,t)):void(n&&n())}):void n(null,new f("Connection must be made before you register push token.",_.INVALID_INITIALIZATION))},this.unregisterGCMPushTokenForCurrentUser=function(e,n){return v.SendBird.currentUser?void t.getInstance().unregisterGCMPushToken(v.SendBird.currentUser.userId,e,function(e,t){return t?void(n&&n(null,t)):void(n&&n())}):void n(null,new f("Connection must be made before you unregister push token.",_.INVALID_INITIALIZATION))},this.unregisterGCMPushTokenAllForCurrentUser=function(e){return v.SendBird.currentUser?void t.getInstance().unregisterGCMPushTokenAll(v.SendBird.currentUser.userId,function(n,t){return t?void(e&&e(null,t)):void(e&&e())}):void e(null,new f("Connection must be made before you unregister push token.",_.INVALID_INITIALIZATION))},this.registerAPNSPushTokenForCurrentUser=function(e,n){return v.SendBird.currentUser?void t.getInstance().registerAPNSPushToken(v.SendBird.currentUser.userId,e,function(e,t){return t?void(n&&n(null,t)):void(n&&n())}):void n(null,new f("Connection must be made before you register push token.",_.INVALID_INITIALIZATION))},this.unregisterAPNSPushTokenForCurrentUser=function(e,n){return v.SendBird.currentUser?void t.getInstance().unregisterAPNSPushToken(v.SendBird.currentUser.userId,e,function(e,t){return t?void(n&&n(null,t)):void(n&&n())}):void n(null,new f("Connection must be made before you unregister push token.",_.INVALID_INITIALIZATION))},this.unregisterAPNSPushTokenAllForCurrentUser=function(e){return v.SendBird.currentUser?void t.getInstance().unregisterAPNSPushTokenAll(v.SendBird.currentUser.userId,function(n,t){return t?void(e&&e(null,t)):void(e&&e())}):void e(null,new f("Connection must be made before you unregister push token.",_.INVALID_INITIALIZATION))},this.blockUser=function(e,n){return v.SendBird.currentUser&&v.SendBird.currentUser.userId!=e.userId?void E.blockUserWithUserId(e.userId,n):void(n&&n(null,new f("Invalid operation.",_.INVALID_INITIALIZATION)))},this.blockUserWithUserId=function(e,n){return v.SendBird.currentUser&&v.SendBird.currentUser.userId!=userToBlock.userId?void t.getInstance().blockUser(v.SendBird.currentUser.userId,e,function(e,t){return t?void(n&&n(null,t)):void(n&&n(new h(e)))}):void(n&&n(null,new f("Invalid operation.",_.INVALID_INITIALIZATION)))},this.unblockUser=function(e,n){return v.SendBird.currentUser?void E.unblockUserWithUserId(e.userId,n):void(n&&n(null,new f("Connection must be made before you unblock users.",_.INVALID_INITIALIZATION)))},this.unblockUserWithUserId=function(e,n){return v.SendBird.currentUser?void t.getInstance().unblockUser(v.SendBird.currentUser.userId,e,function(e,t){return t?void(n&&n(null,t)):void(n&&n())}):void(n&&n(null,new f("Connection must be made before you unblock users.",_.INVALID_INITIALIZATION)))},i=e.appId,c=this,this.OpenChannel=d,this.GroupChannel=u,this.UserMessage=I,t.init(),v.APIClient=t.getInstance(),this}function _(){}function h(e){this.nickname="",this.profileUrl="",this.userId="",this.connectionStatus,this.lastSeenAt=null;if(!e)return this;try{e.hasOwnProperty("guest_id")&&(this.userId=String(e.guest_id)),e.hasOwnProperty("user_id")&&(this.userId=String(e.user_id)),e.hasOwnProperty("name")&&(this.nickname=String(e.name)),e.hasOwnProperty("nickname")&&(this.nickname=String(e.nickname)),e.hasOwnProperty("image")&&(this.profileUrl=String(e.image)),e.hasOwnProperty("profile_url")&&(this.profileUrl=String(e.profile_url)),e.hasOwnProperty("is_online")?this.connectionStatus=e.is_online?h.ONLINE:h.OFFLINE:this.connectionStatus=h.NON_AVAILABLE,e.hasOwnProperty("last_seen_at")?this.lastSeenAt=parseInt(e.last_seen_at):this.lastSeenAt=0}catch(n){O.error(n)}return this}function A(e,n){var r,i,a,s="",o=this;switch(this.hasNext=!0,this.limit=20,this.isLoading=!1,this.next=function(n){if(!o.hasNext)return void(n&&n([],null));if(o.isLoading)return void(n&&n(null,new f("Query in progress.",_.QUERY_IN_PROGRESS)));o.isLoading=!0;var u=function(t,r){if(r)return o.isLoading=!1,void(n&&n(null,r));s=t.next,s||(o.hasNext=!1);var i=t[a],u=[];for(var c in i)e==A.BANNED_USER?u.push(new h(i[c].user)):u.push(new h(i[c]));o.isLoading=!1,n&&n(u,null)};switch(r){case A.ALL_USER:t.getInstance().loadUserList(s,o.limit,u);break;case A.BLOCKED_USER:if(!v.SendBird.currentUser)return void(n&&n(null,new f("Connection must be made before you request the list.",_.INVALID_INITIALIZATION)));t.getInstance().loadBlockedUserList(v.SendBird.currentUser.userId,s,o.limit,u);break;case A.PARTICIPANT:t.getInstance().loadOpenChannelParticipantList(i.url,s,o.limit,u);break;case A.MUTED_USER:t.getInstance().loadOpenChannelMutedList(i.url,s,o.limit,u);break;case A.BANNED_USER:t.getInstance().loadOpenChannelBanList(i.url,s,o.limit,u)}},n&&(i=n),r=e){case A.ALL_USER:case A.BLOCKED_USER:a="users";break;case A.PARTICIPANT:a="participants";break;case A.MUTED_USER:a="muted_list";break;case A.BANNED_USER:a="banned_list"}}function I(e){var n=new i(e);return n.messageType=i.MESSAGE_TYPE_USER,n.message,n.data,n.sender,n.reqId,e?(n.message=String(e.message),n.data=e.hasOwnProperty("data")?String(e.data):"",n.sender=new h(e.user),n.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",n):n}function N(e,n,t,r){this.appId=e,this.SDKVersion=n,this.sessionKey=t?t:"";var i,a,o,u,c,l=this,E=!1,h=3e3,A=0,I=5,p=0,S=!1;r||(H.error("WSClientHandler undefined"),r=new N.WSClientHandler);var C=function(){p=(new Date).getTime()},R=function(){h=3e3,A=0};R(),this.getConnectionState=function(){return 1==a.readyState?v.SendBird.connectionState.OPEN:v.SendBird.connectionState.CLOSED};var U=function(e){var n,t,r=5e3,i=2e3;this.ping=function(){this.stop(),n=setTimeout(function(){var n=s.bPing();l.send(n),t=setTimeout(function(){e()},i)},r)},this.stop=function(){clearTimeout(n),clearTimeout(t)}},g=function(){l.disconnect(!1),S||(r.onReconnectStarted(),S=!0),A==I?r.onReconnectFailed():(clearTimeout(i),i=setTimeout(function(){l.connect(o,u),A++,h*=2},h))},m=new U(g);return this.connect=function(e,n,t){o=e,u=n,c=t;try{var i="undefined"==typeof WebSocket?require("websocket").w3cwebsocket:WebSocket}catch(s){var i=WebSocket}try{var l="/?p=JS&pv="+v.OSVersion+"&sv="+v.SDKVersion+"&ai="+this.appId+"&key="+v.APIClient.sessionKey;a=new i(u+l)}catch(_){return void(c&&c(null,_))}a.onopen=function(e){if(m.ping(),S){for(var n in d.enteredChannels){var t=d.enteredChannels[n];t.enter()}r.onReconnectSucceeded(),R()}else r.onOpen(e);!S&&c&&c(o)},a.onmessage=function(e){C();var n=e.data.split("\n");for(var t in n){var i=n[t];if(i&&"string"==typeof i){try{var a=i.substring(0,4);if("PONG"==a){m.ping();continue}}catch(e){}r.onMessage(i)}}},a.onclose=function(e){E?m.stop():g(),r.onClose(E)},a.onerror=function(e){r.onError(e)}},this.disconnect=function(e){m.stop(),E="undefined"==typeof e||1==e,a.close(),E?r.onClose():r.onErrorClose()},this.send=function(e,n){1!=a.readyState?n&&n(null,new f("WS connection closed.",_.WEBSOCKET_CONNECTION_CLOSED)):(a.send(e.encode()),n&&n(null))},this}n.build=function(e,n,t,i,a){return{msg_id:e,channel_url:n.url,channel_type:n.isOpenChannel()?r.CHANNEL_TYPE_OPEN:r.CHANNEL_TYPE_GROUP,ts:a,message:t,data:i}},t.sInstance=null,t.init=function(){t.sInstance||(t.sInstance=new t)},t.getInstance=function(){return t.sInstance?t.sInstance:(H.error("SendBird instance hasn't been initialized. Try SendBird.init()."),null)},t.API_VERSION="v3",t.API_ROUTING_URL="https://api.sendbird.com/routing/%s",t.API_USERS="/%v/users".replace("%v",t.API_VERSION),t.API_USERS_USERID_LOGIN="/%v/users/%s/login".replace("%v",t.API_VERSION),t.API_USERS_USERID="/%v/users/%s".replace("%v",t.API_VERSION),t.API_USERS_USERID_MARKASREADALL="/%v/users/%s/mark_as_read_all".replace("%v",t.API_VERSION),t.API_USERS_USERID_PUSH_GCM_TOKEN="/%v/users/%s/push/gcm/%s".replace("%v",t.API_VERSION),t.API_USERS_USERID_PUSH_GCM="/%v/users/%s/push/gcm".replace("%v",t.API_VERSION),t.API_USERS_USERID_BLOCK="/%v/users/%s/block".replace("%v",t.API_VERSION),t.API_USERS_USERID_BLOCK_TARGETID="/%v/users/%s/block/%s".replace("%v",t.API_VERSION),t.API_USERS_USERID_PUSH_APNS_TOKEN="/%v/users/%s/push/apns/%s".replace("%v",t.API_VERSION),t.API_USERS_USERID_PUSH_APNS="/%v/users/%s/push/apns".replace("%v",t.API_VERSION),t.API_USERS_USERID_PUSH="/%v/users/%s/push".replace("%v",t.API_VERSION),t.API_OPENCHANNELS="/%v/open_channels".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL="/%v/open_channels/%s".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_MESSAGES="/%v/open_channels/%s/messages".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID="/%v/open_channels/%s/messages/%s".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_PARTICIPANTS="/%v/open_channels/%s/participants".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_METADATA="/%v/open_channels/%s/metadata".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_METADATA_KEY="/%v/open_channels/%s/metadata/%s".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_METACOUNTER="/%v/open_channels/%s/metacounter".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_METACOUNTER_KEY="/%v/open_channels/%s/metacounter/%s".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_BAN="/%v/open_channels/%s/ban".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_BAN_USERID="/%v/open_channels/%s/ban/%s".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_MUTE="/%v/open_channels/%s/mute".replace("%v",t.API_VERSION),t.API_OPENCHANNELS_CHANNELURL_MUTE_USERID="/%v/open_channels/%s/mute/%s".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS="/%v/group_channels".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL="/%v/group_channels/%s".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_INVITE="/%v/group_channels/%s/invite".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_HIDE="/%v/group_channels/%s/hide".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_LEAVE="/%v/group_channels/%s/leave".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_MESSAGES="/%v/group_channels/%s/messages".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASREAD="/%v/group_channels/%s/messages/mark_as_read".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_MESSAGES_TOTALCOUNT="/%v/group_channels/%s/messages/total_count".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_MESSAGES_UNREADCOUNT="/%v/group_channels/%s/messages/unread_count".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID="/%v/group_channels/%s/messages/%s".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_MEMBERS="/%v/group_channels/%s/members".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_METADATA="/%v/group_channels/%s/metadata".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_METADATA_KEY="/%v/group_channels/%s/metadata/%s".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_METACOUNTER="/%v/group_channels/%s/metacounter".replace("%v",t.API_VERSION),t.API_GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY="/%v/group_channels/%s/metacounter/%s".replace("%v",t.API_VERSION),t.API_STORAGE_FILE="/%v/storage/file".replace("%v",t.API_VERSION),t.API_STORAGE_PROFILE="/%v/storage/profile".replace("%v",t.API_VERSION),t.MIME_JSON="application/json; charset=utf-8",t.UPDATE_META_COUNTER_MODE_SET=0,t.UPDATE_META_COUNTER_MODE_INC=1,t.UPDATE_META_COUNTER_MODE_DEC=2,r.CHANNEL_TYPE_OPEN="open",r.CHANNEL_TYPE_GROUP="group",r.CHANNEL_TYPE_BASE="base",i.build=function(e,t){switch(e.type){case"MESG":var r=new h(e.user),i=parseInt(e.message_id),a=String(e.message),s=String(e.data),u=parseInt(e.created_at);return new I(I.build("",i,r,t,a,s,u));case"FILE":var r=new h(e.user),i=parseInt(e.message_id),a=String(e.message),s=String(e.data),u=parseInt(e.created_at),c=e.file,l=String(c.url),d=String(c.name),E=String(c.type),_=parseInt(c.size);return new o(o.build("",i,r,t,l,d,E,_,s,u));case"BRDM":case"ADMM":var i=parseInt(e.message_id),a=String(e.message),s=String(e.data),u=parseInt(e.created_at);return new n(n.build(i,t,a,s,u))}return null},i.MESSAGE_TYPE_BASE="base",i.MESSAGE_TYPE_ADMIN="admin",i.MESSAGE_TYPE_USER="user",i.MESSAGE_TYPE_FILE="file",a.CATEGORY_NONE=0,a.CATEGORY_CHANNEL_ENTER=10102,a.CATEGORY_CHANNEL_EXIT=10103,a.CATEGORY_USER_CHANNEL_MUTE=10201,a.CATEGORY_USER_CHANNEL_UNMUTE=10200,a.CATEGORY_USER_CHANNEL_BAN=10601,a.CATEGORY_USER_CHANNEL_UNBAN=10600,a.CATEGORY_CHANNEL_FREEZE=10701,a.CATEGORY_CHANNEL_UNFREEZE=10700,a.CATEGORY_TYPING_START=10900,a.CATEGORY_TYPING_END=10901,a.CATEGORY_CHANNEL_JOIN=1e4,a.CATEGORY_CHANNEL_LEAVE=10001,a.CATEGORY_CHANNEL_PROP_CHANGED=11e3,a.CATEGORY_CHANNEL_DELETED=12e3,s.bMessage=function(e,n,t,r,i){var a={};a.channel_url=e,a.message=n,a.data=t,a.mentioned=[];for(var o in i){var u=i[o];a.mentioned.push(String(u))}return new s("MESG",a)},s.bTypeStart=function(e,n){var t={};return t.channel_url=e,t.time=n,new s("TPST",t)},s.bTypeEnd=function(e,n){var t={};return t.channel_url=e,t.time=n,new s("TPEN",t)},s.bFile=function(e,n,t,r,i,a,o){var u={};return u.channel_url=n,u.url=t,u.name=r,u.type=i,u.size=a,u.custom=o,new s("FILE",u,e)},s.bPing=function(){var e={};return e.id=(new Date).getTime(),new s("PING",e)},s.bEnter=function(e){var n={};return n.channel_url=e,new s("ENTR",n)},s.bExit=function(e){var n={};return n.channel_url=e,new s("EXIT",n)},s.requestIdSeed=(new Date).getTime(),s.generateRequestId=function(){return s.requestIdSeed++,String(s.requestIdSeed)},o.build=function(e,n,t,i,a,s,o,u,c,l){var d={};d.req_id=e,d.message_id=n,d.channel_url=i.url,d.channel_type=i.channelType==r.CHANNEL_TYPE_OPEN?r.CHANNEL_TYPE_OPEN:r.CHANNEL_TYPE_GROUP,d.ts=l,d.url=a,d.name=s,d.type=o,d.size=u,d.custom=c;var E={};return E.user_id=t.userId,E.nickname=t.nickname,E.profile_url=t.profileUrl,d.user=E,d},u.createMyGroupChannelListQuery=function(){return new c(v.SendBird.currentUser)},u.createChannel=function(){switch(arguments.length){case 3:u._createChannel(arguments[0],arguments[1],null,null,null,arguments[2]);break;case 6:u._createChannel(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])}},u._createChannel=function(e,n,t,r,i,a){var s=[];switch(e.forEach(function(e){s.push(e.userId)}),arguments.length){case 3:u.createChannelWithUserIds(s,n,a);break;case 6:u.createChannelWithUserIds(s,n,t,r,i,a)}},u.createChannelWithUserIds=function(){switch(arguments.length){case 3:u._createChannelWithUserIds(arguments[0],arguments[1],null,null,null,arguments[2]);break;case 6:u._createChannelWithUserIds(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])}},u._createChannelWithUserIds=function(e,n,r,i,a,s){var o=e.filter(function(e,n,t){return n==t.indexOf(e)}),c=v.SendBird.currentUser;o.push(c.userId);var l=o;t.getInstance().createGroupChannel(l,n,r,i,a,function(e,n){if(n)return void(s&&s(null,n));var t=new u(e);u.cachedChannels[t.url]=t,s&&s(t,null)})},u.cachedChannels={},u.clearCache=function(){u.cachedChannels={}},u.getChannelWithoutCache=function(e,n){t.getInstance().getGroupChannel(e,!0,!0,function(t,r){return r?void(n&&n(null,r)):(u.__upsert(t),void(n&&n(u.cachedChannels[e],null)))})},u.getChannel=function(e,n){if(u.cachedChannels.hasOwnProperty(e)){if(n)return void n(u.cachedChannels[e],null)}else u.getChannelWithoutCache(e,n)},u.__upsert=function(e){var n=new u(e);return u.cachedChannels.hasOwnProperty(n.url)?u.cachedChannels[n.url].__update(e):u.cachedChannels[n.url]=n,u.cachedChannels[n.url]},u.markAsReadAllLastSentAt,u.markAsReadAll=function(e){var n=(new Date).getTime();return n-u.markAsReadAllLastSentAt<1e3?void(e&&e(new f("MarkAsRead rate limit exceeded.",_.MARK_AS_READ_RATE_LIMIT_EXCEEDED))):(u.markAsReadAllLastSentAt=n,void t.getInstance().groupChannelMarkAsReadAll(v.SendBird.currentUser.userId,function(n,t){if(t)return void(e&&e(t));for(var r in u.cachedChannels)u.cachedChannels[r].unreadMessageCount=0;e&&e(null)}))},c.ORDER_LATEST_LAST_MESSAGE="latest_last_message",c.ORDER_CHRONOLOGICAL="chronological",d.enteredChannels={},d.clearEnteredChannels=function(){d.enteredChannels={}},d.createOpenChannelListQuery=function(){return new p},d.createChannel=function(){var e,n,t,r,i;switch(arguments.length){case 1:i=arguments[0];break;case 4:e=arguments[0],n=arguments[1],t=arguments[2],i=arguments[3];break;case 5:e=arguments[0],n=arguments[1],t=arguments[2],r=arguments[3],i=arguments[4]}d.createChannelWithOperatorUserIds(e,n,t,r,i)},d.createChannelWithOperatorUserIds=function(e,n,r,i,a){t.getInstance().createOpenChannel(e,n,r,i,function(e,n){if(n)return void(a&&a(null,n));var t=d.__upsert(e);a&&a(t)})},d.getChannel=function(e,n){d.cachedChannels.hasOwnProperty(e)?n&&n(d.cachedChannels[e]):t.getInstance().getOpenChannel(e,function(e,t){if(t)return void(n&&n(null,t));var r=new d(e);n&&n(r)})},d.__upsert=function(e){var n=new d(e);return d.cachedChannels.hasOwnProperty(n.url)?d.cachedChannels[n.url].__update(e):d.cachedChannels[n.url]=n,d.cachedChannels[n.url]},d.cachedChannels={},d.getChannelWithoutCache=function(e,n){t.getInstance().getOpenChannel(e,function(t,r){return r?void(n&&n(null,r)):(d.__upsert(t),void(n&&n(d.cachedChannels[e],null)))})};var p=function(){var e="",n=this;this.limit=20,this.isLoading=!1,this.hasNext=!0,this.next=function(r){return this.hasNext?this.isLoading?void r(null,new f("WS connection closed.",_.QUERY_IN_PROGRESS)):(n.isLoading=!0,void t.getInstance().loadOpenChannelList(e,n.limit,function(t,i){if(i)return n.isLoading=!1,void(r&&r(null,i));var a=t;e=String(a.next),e||(n.hasNext=!1);var s=a.channels,o=[];s.forEach(function(e){var n=d.__upsert(e);o.push(n)}),n.isLoading=!1,r(o,null)})):void r([],null)}},S=function(e){var n=e,r=0x8000000000000000,a=this;this.hasMore=!0,this.isLoading=!1,this.load=function(e,s,o){if(a.hasMore){if(a.isLoading)return void o(null,new f("WS connection closed.",_.QUERY_IN_PROGRESS));a.isLoading=!0,t.getInstance().messageList(n.isOpenChannel(),n.url,r,e,0,!1,s,function(e,t){if(t)return a.isLoading=!1,void(o&&o(null,t));var s=e,u=s.messages,c=[];for(var l in u){var d=i.build(u[l],n);d&&(c.push(d),d.createdAt<=r&&(r=d.createdAt))}c.length<=0&&(a.hasMore=!1),a.isLoading=!1,o&&o(c)})}}},C=function(e){this.reader,this.timestamp,this.channelUrl,this.channelType,this.reader=new h(e.user),this.timestamp=parseInt(e.ts),this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):r.CHANNEL_TYPE_GROUP};_.INVALID_INITIALIZATION=800100,_.CONNECTION_REQUIRED=800101,_.INVALID_PARAMETER=800110,_.NETWORK_ERROR=800120,_.NETWORK_ROUTING_ERROR=800121,_.MALFORMED_DATA=800130,_.MALFORMED_ERROR_DATA=800140,_.WRONG_CHANNEL_TYPE=800150,_.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160,_.QUERY_IN_PROGRESS=800170,_.ACK_TIMEOUT=800180,_.LOGIN_TIMEOUT=800190,_.WEBSOCKET_CONNECTION_CLOSED=800200,_.WEBSOCKET_CONNECTION_FAILED=800210,_.REQUEST_FAILED=800220;var f=function(e,n){return this.code=n?n:0,this.message=e,this};h.NON_AVAILABLE="nonavailable",h.ONLINE="online",h.OFFLINE="offline",h.build=function(e,n,t,r,i){return{user_id:e,nickname:n,profile_url:t,is_online:r,last_seen_at:i}},A.ALL_USER="alluser",A.BLOCKED_USER="blockeduser",A.PARTICIPANT="participant",A.MUTED_USER="muteduser",A.BANNED_USER="banneduser",I.build=function(e,n,t,i,a,s,o){var u={};u.req_id=e,u.msg_id=n,u.channel_url=i.url,u.channel_type=i.channelType==r.CHANNEL_TYPE_OPEN?r.CHANNEL_TYPE_OPEN:r.CHANNEL_TYPE_GROUP,u.ts=o,u.message=a,s&&(u.data=s);var c={};return c.user_id=t.userId,c.nickname=t.nickname,c.profile_url=t.profileUrl,u.user=c,u},N.WSClientHandler=function(){return this.isOpened=!1,this.onReady=function(){},this.onOpen=function(){},this.onClose=function(){},this.onErrorClose=function(){},this.onMessage=function(){},this.onError=function(){},this.onReconnectFailed=function(){},this.onReconnectStarted=function(){},this.onReconnectSucceeded=function(){},this};var v=this;v.WSClient=null,v.APIClient=null;var R=!1,U="wss://ws.sendbird.com",g="https://api.sendbird.com",m="ws://localtest.me:9000",L="http://localtest.me:8000/api";R&&(U=m,g=L);var P="";try{var O=window.console||{log:function(){}}}catch(T){var O={log:function(){}}}var H={log:function(e,n){},error:function(e){}};try{if(!e.hasOwnProperty("appId"))return{}}catch(T){return{}}try{v.OSVersion=navigator.userAgent.replace(/,/g,".")}catch(T){v.OSVersion="undefined"}return v.SDKVersion="3.0.0",v.appId=e.appId,v.SendBird=new E(e),v.SendBird});